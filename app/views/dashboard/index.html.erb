<div class="dashboard-header">
  <h1>📊 ダッシュボード</h1>
  <p class="success-message">🎉 認証に成功しました！</p>
</div>

<div class="user-profile">
  <h3>👤 ユーザープロフィール</h3>
  <div class="profile-grid">
    <div class="profile-item">
      <label>名前:</label>
      <span><%= @user_info['info']['name'] %></span>
    </div>
    <div class="profile-item">
      <label>メール:</label>
      <span><%= @user_info['info']['email'] %></span>
    </div>
    <div class="profile-item">
      <label>プロバイダー:</label>
      <span><%= @user_info['provider'] %></span>
    </div>
    <div class="profile-item">
      <label>UID:</label>
      <span><%= @user_info['uid'] %></span>
    </div>
    <% if @user_info['info']['picture'] %>
    <div class="profile-item">
      <label>プロフィール画像:</label>
      <%= image_tag @user_info['info']['picture'], alt: "Profile", class: "profile-picture" %>
    </div>
    <% end %>
  </div>
</div>

<div class="session-info">
  <h4>🔒 セッション情報</h4>
  <p><strong>認証時刻:</strong> <%= Time.current.strftime("%Y年%m月%d日 %H:%M:%S") %></p>
  <p><strong>認証方式:</strong> OpenID Connect</p>
  <p><strong>セッションサイズ:</strong> 最適化済み（クッキーサイズ制限対応）</p>
</div>

<div class="action-buttons">
  <%= link_to "🏠 ホームに戻る", root_path, class: "btn btn-secondary" %>
  <%= link_to "🚪 ログアウト", logout_path, class: "btn btn-danger" %>
</div>

<% if Rails.env.development? && session[:auth_detailed] %>
<details class="technical-details" style="margin-top: 30px;">
  <summary>🔧 技術的詳細 (開発環境のみ表示)</summary>
  <div class="code-block">
    <pre><%= JSON.pretty_generate(JSON.parse(session[:auth_detailed])) %></pre>
  </div>
</details>
<% else %>
<div class="technical-details" style="margin-top: 30px;">
  <p><strong>💡 セッション最適化:</strong> 本番環境では詳細情報はセキュリティのため表示されません。</p>
</div>
<% end %>

<div class="rails8-info">
  <h4>🆕 Rails 8.0 + セッション管理について</h4>
  <p>このアプリでは<strong>クッキーサイズ制限</strong>に対応した最適化を実装しています。</p>
  <ul>
    <li><strong>最小化:</strong> セッションには必要最小限の情報のみ保存</li>
    <li><strong>セキュリティ:</strong> 機密情報はサーバーサイドで管理</li>
    <li><strong>パフォーマンス:</strong> 軽量なセッションでレスポンス向上</li>
    <li><strong>スケーラビリティ:</strong> データベースセッション対応</li>
  </ul>
</div>